# ëª©í‘œ
- countë¥¼ ì‚¬ìš©í•˜ëŠ” ê²½ìš°, ë¦¬ì†ŒìŠ¤ êµì²´ê°€ ë°œìƒí•˜ëŠ” ìƒí™©ì„ ì¬í˜„
- ìƒí™© ì¬í˜„ ë°©ë²•
```
1. terraform apply
2. terraform.tfvarsíŒŒì¼ì—ì„œ subnetsê°’ ì²«ë²ˆì§¸ ìš”ì†Œë¥¼ ì£¼ì„ì²˜ë¦¬ (ë¦¬ì†ŒìŠ¤ ì‚­ì œ ê°€ì •)
3. terraform planì˜ ê²°ê³¼ë¥¼ í™•ì¸. EC2 instanceëŠ” replacedí‘œì‹œ í™•ì¸.
```


âœ… ìƒí™©
Terraformì—ì„œ count ë¥¼ ì¨ì„œ ì—¬ëŸ¬ ê°œì˜ ë¦¬ì†ŒìŠ¤ë¥¼ ë°˜ë³µ ìƒì„±í•  ë•Œ,

```hcl
resource "aws_subnet" "public" {
  count = length(var.public_subnets)
  ...
}
```
- ìƒì„±ëœ ì„œë¸Œë„·ë“¤ì€ aws_subnet.public[0].id, aws_subnet.public[1].id ì²˜ëŸ¼ index ê¸°ë°˜ìœ¼ë¡œ ì ‘ê·¼
- ë¬¸ì œëŠ” ì„œë¸Œë„· ë°°ì—´ì˜ ìˆœì„œê°€ ë°”ë€Œê±°ë‚˜, ì¤‘ê°„ì— ì‚­ì œ/ì¶”ê°€ë˜ë©´ indexê°€ ê¼¬ì´ë©´ì„œ ê´€ë ¨ëœ ë¦¬ì†ŒìŠ¤(ì˜ˆ: EC2)ê¹Œì§€ ê°™ì´ ì‚­ì œ/ì¬ìƒì„±ë˜ëŠ” ë¬¸ì œê°€ ë°œìƒ

âœ… ê¸°ì¡´ ì½”ë“œì˜ ë¬¸ì œ (index ì ‘ê·¼ ë°©ì‹)
```hcl
subnet_id = aws_subnet.public[1].id
```
- ì´ë ‡ê²Œ ì“°ë©´ ë‹¨ìˆœíˆ ë‘ ë²ˆì§¸ ì„œë¸Œë„·ì„ ì°¸ì¡°
- ë§Œì•½ aws_subnet.public ì˜ ìˆœì„œê°€ ë°”ë€Œë©´? â†’ ì˜ë„í•˜ì§€ ì•Šì€ ë‹¤ë¥¸ ì„œë¸Œë„·ì„ ì°¸ì¡°í•˜ê²Œ ë¨.
- ì‹¬í•˜ë©´ ì„œë¸Œë„·ì´ ë°”ë€Œë©´ì„œ EC2ê°€ ì‚­ì œ & ì¬ìƒì„±ë˜ëŠ” ì¼ì´ ë°œìƒ.

âœ…  ì½”ë“œ ë³€ê²½ (index() í•¨ìˆ˜ë¡œ ë§¤ì¹­ ë°©ì‹)
```hcl
# index ì ‘ê·¼ ë°©ë²• ì˜¤ë¥˜ í•´ê²° ì½”ë“œ
subnet_id = aws_subnet.public[index(aws_subnet.public.*.cidr_block, "10.220.11.64/26")].id
```
ğŸ”‘  í•´ì„:

â¡ï¸ `aws_subnet.public.*.cidr_block` :
  - ëª¨ë“  ì„œë¸Œë„·ì˜ cidr_block ê°’ì„ ë¦¬ìŠ¤íŠ¸ë¡œ ê°€ì ¸ì˜´.
  - ì˜ˆ: ["10.220.11.0/26", "10.220.11.64/26"]

â¡ï¸ `index(..., "10.220.11.64/26")` :
  - ìœ„ ë¦¬ìŠ¤íŠ¸ì—ì„œ "10.220.11.64/26" ê°€ ëª‡ ë²ˆì§¸ì¸ì§€ ì°¾ì•„ì„œ index ë²ˆí˜¸ ë°˜í™˜.
  - ì˜ˆ: 1 (ë‘ ë²ˆì§¸ ìœ„ì¹˜)

â¡ï¸ `aws_subnet.public[<index>].id` :
  - ì°¾ì€ ì¸ë±ìŠ¤ë¥¼ ì´ìš©í•´ í•´ë‹¹ ì„œë¸Œë„·ì˜ id ì°¸ì¡°.
  - ì¦‰, CIDR ëŒ€ì—­ì„ ê¸°ì¤€ìœ¼ë¡œ ì •í™•íˆ ì¼ì¹˜í•˜ëŠ” ì„œë¸Œë„·ì„ ì°¾ì•„ì„œ í• ë‹¹í•˜ëŠ” ë°©ì‹.

